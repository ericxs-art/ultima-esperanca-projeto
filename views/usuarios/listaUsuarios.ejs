<!-- Cabecalho principal  -->
<%- include('../partials/header') %>

    <!-- Conteudo do index  -->
    <main class="container text-center mt-3">
        <h1>LISTA DE USUÁRIOS</h1>
        <a href="/usuarios/cadastrar">
            <button class="btn btn-lg btn-primary">
                <i class="bi bi-brightness-high-fill"></i>
                Cadastrar
            </button>
        </a>
        <!-- criando  a tabela de acordo com a lista de usuarios -->
        <% if (usuarios && usuarios.length> 0) { %>
            <!-- criando a tabelA -->
            <table class="table table-striped table-hover align-middle mt-5">
                <!-- cabeçalho da tabela -->
                <thead class="table-dark">
                    <tr class="text-center">
                        <th scope="col">ID </th>
                        <th scope="col">Usuario </th>
                        <th scope="col">E-mail </th>
                        <th scope="col">Tipo </th>
                        <th scope="col">Ações </th>
                    </tr>
                </thead>
                <!-- corpo da tabela -->
                <tbody>
                    <!-- usando essa função foreach para pecorrer o array de usuarios -->
                    <% usuarios.forEach((usuario)=> { %>
                        <tr>
                            <td>
                                <%= usuario.id %>
                            </td>
                            <td>
                                <%= usuario.usuario %>
                            </td>
                            <td>
                                <%= usuario.email %>
                            </td>
                            <td>
                                <%= usuario.tipo %>
                            </td>
                            <td>
                                <!-- editar  -->
                                <a href="/usuarios/<%= usuario.id %>">
                                    <button class="btn btn-sm btn-warning me-2">
                                        <i class="bi bi-pencil-square"></i>
                                        Editar
                                    </button>
                                </a>
                                <!-- excluir -->
                                <a href="#">
                                    <button class="btn btn-sm btn-danger"
                                        onclick="confirmaExclusao('<%= usuario.usuario %>', '<%=usuario.id %>')">
                                        <i class="bi bi-trash3"></i>
                                        Excluir
                                    </button>
                                </a>

                            </td>
                        </tr>
                        <% }) %>
                </tbody>
            </table>
            <% } else { %>
                <!-- Mostra uma mensagem, caso não tenha nenhhum usuário cadastro -->
                <div class="alert alert-warning text-center mt-5">
                    Nenhum usuário cadastrado no momento.
                </div>
                <% } %>

                    <!-- Criação do script para a função de deletar -->
                    <script>
                        function confirmaExclusao(nomeUsuario, id) {
                            if (confirm(`Deseja realmente excluir o usuario ${nomeUsuario}`)){
                                window.location.href = ` /usuarios/deletar/${id}`
                            }
                        }
                    </script>
    </main>

    <!-- Rodape de todas as páginas  -->
    <%- include('../partials/footer') %>